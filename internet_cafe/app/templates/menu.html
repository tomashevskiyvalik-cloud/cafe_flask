{% extends 'base.html' %}

{% block title %}–ú–µ–Ω—é - –ö–∞—Ñ–µ{% endblock %}

{% block content %}

<div class="menu-head">
  <div>
    <h1 class="menu-title">–ú–µ–Ω—é</h1>
    <p class="menu-sub">–û–±–µ—Ä–∏ —â–æ—Å—å —Å–º–∞—á–Ω–µ ‚Äî —ñ –∑–∞–º–æ–≤–ª—è–π –ø—Ä—è–º–æ –Ω–∞ —Å–∞–π—Ç—ñ üôÇ</p>
  </div>
</div>

<!-- üîç –ü–û–®–£–ö + –°–û–†–¢–£–í–ê–ù–ù–Ø -->
<form method="GET" class="menu-filters" style="display:flex; gap:12px; flex-wrap:wrap; margin:16px 0;">
  <input
    type="text"
    name="q"
    value="{{ q }}"
    placeholder="–ü–æ—à—É–∫ –ø–æ –º–µ–Ω—é..."
    style="padding:10px; min-width:220px;"
  >

  <select name="sort" style="padding:10px;">
    <option value="new" {% if sort=='new' %}selected{% endif %}>–°–ø–æ—á–∞—Ç–∫—É –Ω–æ–≤—ñ</option>
    <option value="price_asc" {% if sort=='price_asc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üë</option>
    <option value="price_desc" {% if sort=='price_desc' %}selected{% endif %}>–¶—ñ–Ω–∞ ‚Üì</option>
    <option value="name" {% if sort=='name' %}selected{% endif %}>–ù–∞–∑–≤–∞ A‚ÜíZ</option>
  </select>

  <button type="submit" style="padding:10px 16px;">–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏</button>
</form>

<!-- üçΩÔ∏è –ú–ï–ù–Æ -->
<div class="menu-grid">
  {% for tovar in tovary %}
    <div class="menu-card">

      <div class="menu-media">
        {% if tovar.image_filename %}
          <img src="{{ url_for('static', filename='uploads/tovary/' ~ tovar.image_filename) }}"
               alt="{{ tovar.nazva }}">
        {% else %}
          <div class="menu-placeholder">
            <div style="font-size:32px;">‚òï</div>
            <div>–§–æ—Ç–æ –Ω–µ–º–∞—î</div>
          </div>
        {% endif %}
      </div>

      <div class="menu-body">
        <div class="menu-row">
          <h2 class="menu-name">{{ tovar.nazva }}</h2>
          <div class="menu-price">{{ tovar.tsina }} –≥—Ä–Ω</div>
        </div>

        <p class="menu-desc">{{ tovar.opis }}</p>

        <div class="menu-actions">
          <a class="menu-btn" href="{{ url_for('main.order', tovar_id=tovar.id) }}">
            üõí –ó–∞–º–æ–≤–∏—Ç–∏
          </a>
        </div>
      </div>
    </div>
  {% else %}
    <div class="menu-empty">
      <h2>–ú–µ–Ω—é –ø–æ–∫–∏ —â–æ –ø–æ—Ä–æ–∂–Ω—î</h2>
      <p>–ó–∞–π–¥–∏ –≤ –∞–¥–º—ñ–Ω–∫—É —Ç–∞ –¥–æ–¥–∞–π –ø–µ—Ä—à—ñ —Å—Ç—Ä–∞–≤–∏ ‚ú®</p>
    </div>
  {% endfor %}
</div>

<!-- üìÑ –ü–ê–ì–Ü–ù–ê–¶–Ü–Ø -->
{% if pagination and pagination.pages > 1 %}
<div class="pagination" style="margin:20px 0; display:flex; gap:12px; align-items:center;">
  {% if pagination.has_prev %}
    <a href="{{ url_for('main.menu', page=pagination.prev_num, q=q, sort=sort) }}">‚Üê –ù–∞–∑–∞–¥</a>
  {% endif %}

  <span>–°—Ç–æ—Ä—ñ–Ω–∫–∞ {{ pagination.page }} / {{ pagination.pages }}</span>

  {% if pagination.has_next %}
    <a href="{{ url_for('main.menu', page=pagination.next_num, q=q, sort=sort) }}">–î–∞–ª—ñ ‚Üí</a>
  {% endif %}
</div>
{% endif %}

{% endblock %}